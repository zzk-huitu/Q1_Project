<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='Extensible-calendar-CalendarPanel'>/**
</span> * This is the default container for calendar views. It supports day, week, multi-week and month views as well
 * as a built-in event edit form. The only requirement for displaying a calendar is passing in a valid
 * {@link #Ext.data.Store store} config containing records of type
 * {@link Extensible.calendar.data.EventModel EventRModel}.
 */
Ext.define(&#39;Extensible.calendar.CalendarPanel&#39;, {
    extend: &#39;Ext.panel.Panel&#39;,
    alias: &#39;widget.extensible.calendarpanel&#39;,
    
    requires: [
        &#39;Ext.layout.container.Card&#39;,
        &#39;Extensible.calendar.view.Day&#39;,
        &#39;Extensible.calendar.view.Week&#39;,
        &#39;Extensible.calendar.view.Month&#39;,
        &#39;Extensible.calendar.view.MultiDay&#39;,
        &#39;Extensible.calendar.view.MultiWeek&#39;
    ],
    
<span id='Extensible-calendar-CalendarPanel-cfg-activeItem'>    /**
</span>     * @cfg {Number} activeItem
     * The 0-based index within the available views to set as the default active view (defaults to undefined).
     * If not specified the default view will be set as the last one added to the panel. You can retrieve a
     * reference to the active {@link Extensible.calendar.view.AbstractCalendar view} at any time using the
     * {@link #activeView} property.
     */
<span id='Extensible-calendar-CalendarPanel-cfg-recurrence'>    /**
</span>     * @cfg {Boolean} recurrence
     * True to enable event recurrence, false to disable it (default). Note that at this time this
     * requires handling code on the server-side that can parse the iCal RRULE format in order to generate
     * the instances of recurring events to display on the calendar, so this field should only be enabled
     * if the server supports it.
     */
    recurrence: false,
<span id='Extensible-calendar-CalendarPanel-cfg-showDayView'>    /**
</span>     * @cfg {Boolean} showDayView
     * True to include the day view (and toolbar button), false to hide them (defaults to true).
     */
    showDayView: true,
<span id='Extensible-calendar-CalendarPanel-cfg-showMultiDayView'>    /**
</span>     * @cfg {Boolean} showMultiDayView
     * True to include the multi-day view (and toolbar button), false to hide them (defaults to false).
     */
    showMultiDayView: false,
<span id='Extensible-calendar-CalendarPanel-cfg-showWeekView'>    /**
</span>     * @cfg {Boolean} showWeekView
     * True to include the week view (and toolbar button), false to hide them (defaults to true).
     */
    showWeekView: true,
<span id='Extensible-calendar-CalendarPanel-cfg-showMultiWeekView'>    /**
</span>     * @cfg {Boolean} showMultiWeekView
     * True to include the multi-week view (and toolbar button), false to hide them (defaults to true).
     */
    showMultiWeekView: true,
<span id='Extensible-calendar-CalendarPanel-cfg-showMonthView'>    /**
</span>     * @cfg {Boolean} showMonthView
     * True to include the month view (and toolbar button), false to hide them (defaults to true).
     * If all other views are hidden, the month view will show by default even if this config is false.
     */
    showMonthView: true,
<span id='Extensible-calendar-CalendarPanel-cfg-showNavBar'>    /**
</span>     * @cfg {Boolean} showNavBar
     * True to display the calendar navigation toolbar, false to hide it (defaults to true). Note that
     * if you hide the default navigation toolbar you&#39;ll have to provide an alternate means of navigating
     * the calendar.
     */
    showNavBar: true,
<span id='Extensible-calendar-CalendarPanel-cfg-todayText'>    /**
</span>     * @cfg {String} todayText
     * Text to use for the &#39;Today&#39; nav bar button.
     */
    todayText: &#39;Today&#39;,
<span id='Extensible-calendar-CalendarPanel-cfg-showTodayText'>    /**
</span>     * @cfg {Boolean} showTodayText
     * True to show the value of {@link #todayText} instead of today&#39;s date in the calendar&#39;s current day box,
     * false to display the day number(defaults to true).
     */
    showTodayText: true,
<span id='Extensible-calendar-CalendarPanel-cfg-showTime'>    /**
</span>     * @cfg {Boolean} showTime
     * True to display the current time next to the date in the calendar&#39;s current day box, false to not show it
     * (defaults to true).
     */
    showTime: true,
<span id='Extensible-calendar-CalendarPanel-cfg-readOnly'>    /**
</span>     * @cfg {Boolean} readOnly
     * True to prevent clicks on events or calendar views from providing CRUD capabilities, false to enable CRUD
     * (the default). This option is passed into all views managed by this CalendarPanel.
     */
    readOnly: false,
<span id='Extensible-calendar-CalendarPanel-cfg-showNavToday'>    /**
</span>     * @cfg {Boolean} showNavToday
     * True to display the &quot;Today&quot; button in the calendar panel&#39;s navigation header, false to not
     * show it (defaults to true).
     */
    showNavToday: true,
<span id='Extensible-calendar-CalendarPanel-cfg-showNavJump'>    /**
</span>     * @cfg {Boolean} showNavJump
     * True to display the &quot;Jump to:&quot; label in the calendar panel&#39;s navigation header, false to not
     * show it (defaults to true).
     */
    showNavJump: true,
<span id='Extensible-calendar-CalendarPanel-cfg-showNavNextPrev'>    /**
</span>     * @cfg {Boolean} showNavNextPrev
     * True to display the left/right arrow buttons in the calendar panel&#39;s navigation header, false to not
     * show it (defaults to true).
     */
    showNavNextPrev: true,
<span id='Extensible-calendar-CalendarPanel-cfg-jumpToText'>    /**
</span>     * @cfg {String} jumpToText
     * Text to use for the &#39;Jump to:&#39; navigation label.
     */
    jumpToText: &#39;Jump to:&#39;,
<span id='Extensible-calendar-CalendarPanel-cfg-goText'>    /**
</span>     * @cfg {String} goText
     * Text to use for the &#39;Go&#39; navigation button.
     */
    goText: &#39;Go&#39;,
<span id='Extensible-calendar-CalendarPanel-cfg-dayText'>    /**
</span>     * @cfg {String} dayText
     * Text to use for the &#39;Day&#39; nav bar button.
     */
    dayText: &#39;Day&#39;,
<span id='Extensible-calendar-CalendarPanel-cfg-multiDayText'>    /**
</span>     * @cfg {String} multiDayText
     * **Deprecated.** Please override {@link #getMultiDayText} instead.
     * 
     * Text to use for the &#39;X Days&#39; nav bar button (defaults to &quot;{0} Days&quot; where {0} is automatically
     * replaced by the value of the {@link #multDayViewCfg}&#39;s dayCount value if available, otherwise it
     * uses the view default of 3).
     * @deprecated
     */
    multiDayText: &#39;{0} Days&#39;,
<span id='Extensible-calendar-CalendarPanel-cfg-weekText'>    /**
</span>     * @cfg {String} weekText
     * Text to use for the &#39;Week&#39; nav bar button.
     */
    weekText: &#39;Week&#39;,
<span id='Extensible-calendar-CalendarPanel-cfg-multiWeekText'>    /**
</span>     * @cfg {String} multiWeekText
     * **Deprecated.** Please override {@link #getMultiWeekText} instead.
     * 
     * Text to use for the &#39;X Weeks&#39; nav bar button (defaults to &quot;{0} Weeks&quot; where {0} is automatically
     * replaced by the value of the {@link #multiWeekViewCfg}&#39;s weekCount value if available, otherwise it
     * uses the view default of 2).
     * @deprecated
     */
    multiWeekText: &#39;{0} Weeks&#39;,
<span id='Extensible-calendar-CalendarPanel-cfg-monthText'>    /**
</span>     * @cfg {String} monthText
     * Text to use for the &#39;Month&#39; nav bar button.
     */
    monthText: &#39;Month&#39;,
<span id='Extensible-calendar-CalendarPanel-cfg-editModal'>    /**
</span>     * @cfg {Boolean} editModal
     * True to show the default event editor window modally over the entire page, false to allow user
     * interaction with the page while showing the window (the default). Note that if you replace the
     * default editor window with some alternate component this config will no longer apply.
     */
    editModal: false,
<span id='Extensible-calendar-CalendarPanel-cfg-enableEditDetails'>    /**
</span>     * @cfg {Boolean} enableEditDetails
     * True to show a link on the event edit window to allow switching to the detailed edit form (the
     * default), false to remove the link and disable detailed event editing.
     */
    enableEditDetails: true,
<span id='Extensible-calendar-CalendarPanel-cfg-startDay'>    /**
</span>     * @cfg {Number} startDay
     * The 0-based index for the day on which the calendar week begins (0=Sunday, which is the default)
     */
    startDay: 0,
<span id='Extensible-calendar-CalendarPanel-cfg-eventStore'>    /**
</span>     * @cfg {Ext.data.Store} eventStore
     * The {@link Ext.data.Store store} which is bound to this calendar and contains
     * {@link Extensible.calendar.data.EventModel EventModels}. Note that this is an alias to the
     * default {@link #store} config (to differentiate that from the optional {@link #calendarStore}
     * config), and either can be used interchangeably.
     */
<span id='Extensible-calendar-CalendarPanel-cfg-calendarStore'>    /**
</span>     * @cfg {Ext.data.Store} calendarStore
     * The {@link Ext.data.Store store} which is bound to this calendar and contains
     * {@link Extensible.calendar.data.CalendarModel CalendarModelss}. This is an optional store that
     * provides multi-calendar (and multi-color) support. If available an additional field for selecting
     * the calendar in which to save an event will be shown in the edit forms. If this store is not
     * available then all events will simply use the default calendar (and color).
     */
<span id='Extensible-calendar-CalendarPanel-cfg-viewConfig'>    /**
</span>     * @cfg {Object} viewConfig
     * A config object that will be applied to all {@link Extensible.calendar.view.AbstractCalendar views}
     * managed by this CalendarPanel. Any options on this object that do not apply to any particular view
     * will simply be ignored.
     */
<span id='Extensible-calendar-CalendarPanel-cfg-dayViewCfg'>    /**
</span>     * @cfg {Object} dayViewCfg
     * A config object that will be applied only to the {@link Extensible.calendar.view.Day DayView}
     * managed by this CalendarPanel.
     */
<span id='Extensible-calendar-CalendarPanel-cfg-multiDayViewCfg'>    /**
</span>     * @cfg {Object} multiDayViewCfg
     * A config object that will be applied only to the {@link Extensible.calendar.view.MultiDay MultiDayView}
     * managed by this CalendarPanel.
     */
<span id='Extensible-calendar-CalendarPanel-cfg-weekViewCfg'>    /**
</span>     * @cfg {Object} weekViewCfg
     * A config object that will be applied only to the {@link Extensible.calendar.view.Week WeekView}
     * managed by this CalendarPanel.
     */
<span id='Extensible-calendar-CalendarPanel-cfg-multiWeekViewCfg'>    /**
</span>     * @cfg {Object} multiWeekViewCfg
     * A config object that will be applied only to the {@link Extensible.calendar.view.MultiWeek MultiWeekView}
     * managed by this CalendarPanel.
     */
<span id='Extensible-calendar-CalendarPanel-cfg-monthViewCfg'>    /**
</span>     * @cfg {Object} monthViewCfg
     * A config object that will be applied only to the {@link Extensible.calendar.view.Month MonthView}
     * managed by this CalendarPanel.
     */
<span id='Extensible-calendar-CalendarPanel-cfg-editViewCfg'>    /**
</span>     * @cfg {Object} editViewCfg
     * A config object that will be applied only to the {@link Extensible.calendar.form.EventDetails
     * EventEditForm} managed by this CalendarPanel.
     */
    
<span id='Extensible-calendar-CalendarPanel-property-activeView'>    /**
</span>     * A reference to the {@link Extensible.calendar.view.AbstractCalendar view} that is currently active.
     * @type {Extensible.calendar.view.AbstractCalendar}
     * @property activeView
     */

    layout: {
        type: &#39;card&#39;,
        deferredRender: true
    },
    
<span id='Extensible-calendar-CalendarPanel-property-startDate'>    // private property
</span>    startDate: new Date(),

<span id='Extensible-calendar-CalendarPanel-method-initComponent'>    initComponent: function() {
</span>        this.tbar = {
            cls: &#39;ext-cal-toolbar&#39;,
            border: true,
            items: []
        };
        
        this.viewCount = 0;
        
        var text,
            multiDayViewCount = (this.multiDayViewCfg &amp;&amp; this.multiDayViewCfg.dayCount) || 3,
            multiWeekViewCount = (this.multiWeekViewCfg &amp;&amp; this.multiWeekViewCfg.weekCount) || 2;
        
        //
        // TODO: Pull the configs for the toolbar/buttons out to the prototype for overrideability
        //
        if(this.showNavToday) {
            this.tbar.items.push({
                id: this.id+&#39;-tb-today&#39;, text: this.todayText, handler: this.onTodayClick, scope: this
            });
        }
        if(this.showNavNextPrev) {
            this.tbar.items.push({id: this.id+&#39;-tb-prev&#39;, handler: this.onPrevClick, scope: this, iconCls: &#39;x-tbar-page-prev&#39;});
            this.tbar.items.push({id: this.id+&#39;-tb-next&#39;, handler: this.onNextClick, scope: this, iconCls: &#39;x-tbar-page-next&#39;});
        }
        if(this.showNavJump) {
            this.tbar.items.push(this.jumpToText);
            this.tbar.items.push({id: this.id+&#39;-tb-jump-dt&#39;, xtype: &#39;datefield&#39;, width: 120, showToday: false, startDay: this.startDay});
            this.tbar.items.push({id: this.id+&#39;-tb-jump&#39;, text: this.goText, handler: this.onJumpClick, scope: this});
        }
        
        this.tbar.items.push(&#39;-&gt;&#39;);
        
        if(this.showDayView) {
            this.tbar.items.push({
                id: this.id+&#39;-tb-day&#39;, text: this.dayText, handler: this.onDayNavClick, scope: this, toggleGroup: this.id+&#39;-tb-views&#39;
            });
            this.viewCount++;
        }
        if(this.showMultiDayView) {
            text = Ext.String.format(this.getMultiDayText(multiDayViewCount), multiDayViewCount);
            this.tbar.items.push({
                id: this.id+&#39;-tb-multiday&#39;, text: text, handler: this.onMultiDayNavClick, scope: this, toggleGroup: this.id+&#39;-tb-views&#39;
            });
            this.viewCount++;
        }
        if(this.showWeekView) {
            this.tbar.items.push({
                id: this.id+&#39;-tb-week&#39;, text: this.weekText, handler: this.onWeekNavClick, scope: this, toggleGroup: this.id+&#39;-tb-views&#39;
            });
            this.viewCount++;
        }
        if(this.showMultiWeekView) {
            text = Ext.String.format(this.getMultiWeekText(multiWeekViewCount), multiWeekViewCount);
            this.tbar.items.push({
                id: this.id+&#39;-tb-multiweek&#39;, text: text, handler: this.onMultiWeekNavClick, scope: this, toggleGroup: this.id+&#39;-tb-views&#39;
            });
            this.viewCount++;
        }
        if(this.showMonthView || this.viewCount === 0) {
            this.tbar.items.push({
                id: this.id+&#39;-tb-month&#39;, text: this.monthText, handler: this.onMonthNavClick, scope: this, toggleGroup: this.id+&#39;-tb-views&#39;
            });
            this.viewCount++;
            this.showMonthView = true;
        }
        
        var idx = this.viewCount-1;
        this.activeItem = (this.activeItem === undefined ? idx : (this.activeItem &gt; idx ? idx : this.activeItem));
        
        if(this.showNavBar === false) {
            delete this.tbar;
            this.addCls(&#39;x-calendar-nonav&#39;);
        }
        
        this.callParent(arguments);
        
        this.addEvents({
<span id='Extensible-calendar-CalendarPanel-event-eventadd'>            /**
</span>             * @event eventadd
             * Fires after a new event is added to the underlying store
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.calendar.data.EventModel} rec The new 
             * {@link Extensible.calendar.data.EventModel record} that was added
             */
            eventadd: true,
<span id='Extensible-calendar-CalendarPanel-event-eventupdate'>            /**
</span>             * @event eventupdate
             * Fires after an existing event is updated
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.calendar.data.EventModel} rec The new 
             * {@link Extensible.calendar.data.EventModel record} that was updated
             */
            eventupdate: true,
<span id='Extensible-calendar-CalendarPanel-event-beforeeventdelete'>            /**
</span>             * @event beforeeventdelete
             * Fires before an event is deleted by the user. This is a cancelable event, so returning
             * false from a handler will cancel the delete operation.
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.calendar.data.EventModel} rec The {@link Extensible.calendar.data.EventModel record}
             * for the event that was deleted
             * @param {Ext.Element} el The target element
             */
            beforeeventdelete: true,
<span id='Extensible-calendar-CalendarPanel-event-eventdelete'>            /**
</span>             * @event eventdelete
             * Fires after an event is deleted by the user.
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.calendar.data.EventModel} rec The 
             * {@link Extensible.calendar.data.EventModel record} for the event that was deleted
             * @param {Ext.Element} el The target element
             */
            eventdelete: true,
<span id='Extensible-calendar-CalendarPanel-event-eventcancel'>            /**
</span>             * @event eventcancel
             * Fires after an event add/edit operation is canceled by the user and no store update took place
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.calendar.data.EventModel} rec The new
             * {@link Extensible.calendar.data.EventModel record} that was canceled
             */
            eventcancel: true,
<span id='Extensible-calendar-CalendarPanel-event-viewchange'>            /**
</span>             * @event viewchange
             * Fires after a different calendar view is activated (but not when the event edit form is activated)
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.CalendarView} view The view being activated (any valid 
             * {@link Extensible.calendar.view.AbstractCalendar CalendarView} subclass)
             * @param {Object} info Extra information about the newly activated view. This is a plain object
             * with following properties:
             * 
             *	* **activeDate**
             *		* The currently selected date
             *	* **viewStart**
             *		* The first date in the new view range
             *	* **viewEnd**
             *		* The last date in the new view range
             */
            viewchange: true,
<span id='Extensible-calendar-CalendarPanel-event-editdetails'>            /**
</span>             * @event editdetails
             * Fires when the user selects the option to edit the selected event in the detailed edit form
             * (by default, an instance of {@link Extensible.calendar.form.EventDetails}). Handling code
             * should hide the active event editor and transfer the current event record to the appropriate
             * instance of the detailed form by showing it and calling
             * {@link Extensible.calendar.form.EventDetails#loadRecord loadRecord}.
             * @param {Extensible.calendar.CalendarPanel} this The CalendarPanel
             * @param {Extensible.calendar.view.AbstractCalendar} view The currently active 
             * {@link Extensible.calendar.view.AbstractCalendar CalendarView} subclass
             * @param {Extensible.calendar.data.EventModel} rec The 
             * {@link Extensible.calendar.data.EventModel record} that is currently being edited
             * @param {Ext.Element} el The target element
             */
            editdetails: true
            
            
            //
            // NOTE: CalendarPanel also relays the following events from contained views as if
            // they originated from this:
            //
            
<span id='Extensible-calendar-CalendarPanel-event-eventsrendered'>            /**
</span>             * @event eventsrendered
             * Fires after events are finished rendering in the view
             * @param {Extensible.calendar.CalendarPanel} this
             */
<span id='Extensible-calendar-CalendarPanel-event-eventclick'>            /**
</span>             * @event eventclick
             * Fires after the user clicks on an event element.
             * 
             * **NOTE:** This version of &lt;tt&gt;eventclick&lt;/tt&gt; differs from the same
             * event fired directly by {@link Extensible.calendar.view.AbstractCalendar CalendarView}
             * subclasses in that it provides a default implementation (showing the default edit window)
             * and is also cancelable (if a handler returns &lt;tt&gt;false&lt;/tt&gt; the edit window will not be
             * shown). This event when fired from a view class is simply a notification that an event was
             * clicked and has no default behavior.
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.calendar.data.EventModel} rec The 
             * {@link Extensible.calendar.data.EventModel record} for the event that was clicked on
             * @param {HTMLNode} el The DOM node that was clicked on
             */
<span id='Extensible-calendar-CalendarPanel-event-rangeselect'>            /**
</span>             * @event rangeselect
             * Fires after the user drags on the calendar to select a range of dates/times in which to
             * create an event
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Object} dates An object containing the start (StartDate property) and end (EndDate
             * property) dates selected
             * @param {Function} callback A callback function that MUST be called after the event handling 
             * is complete so that the view is properly cleaned up (shim elements are persisted in 
             * the view while the user is prompted to handle the range selection). The callback is 
             * already created in the proper scope, so it simply needs to be executed as a standard 
             * function call (e.g., callback()).
             */
<span id='Extensible-calendar-CalendarPanel-event-eventover'>            /**
</span>             * @event eventover
             * Fires anytime the mouse is over an event element
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.calendar.data.EventModel} rec The 
             * {@link Extensible.calendar.data.EventModel record} for the event that the cursor is over
             * @param {HTMLNode} el The DOM node that is being moused over
             */
<span id='Extensible-calendar-CalendarPanel-event-eventout'>            /**
</span>             * @event eventout
             * Fires anytime the mouse exits an event element
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.calendar.data.EventModel} rec The 
             * {@link Extensible.calendar.data.EventModel record} for the event that the cursor exited
             * @param {HTMLNode} el The DOM node that was exited
             */
<span id='Extensible-calendar-CalendarPanel-event-beforedatechange'>            /**
</span>             * @event beforedatechange
             * Fires before the start date of the view changes, giving you an opportunity to save state or
             * anything else you may need to do prior to the UI view changing. This is a cancelable event, so
             * returning false from a handler will cancel both the view change and the setting of the start date.
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Date} startDate The current start date of the view (as explained in {@link #getStartDate}
             * @param {Date} newStartDate The new start date that will be set when the view changes
             * @param {Date} viewStart The first displayed date in the current view
             * @param {Date} viewEnd The last displayed date in the current view
             */
<span id='Extensible-calendar-CalendarPanel-event-dayclick'>            /**
</span>             * @event dayclick
             * Fires after the user clicks within a day/week view container and not on an event element
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Date} dt The date/time that was clicked on
             * @param {Boolean} allday True if the day clicked on represents an all-day box, else false.
             * @param {Ext.Element} el The Element that was clicked on
             */
<span id='Extensible-calendar-CalendarPanel-event-datechange'>            /**
</span>             * @event datechange
             * Fires after the start date of the view changes
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Date} startDate The start date of the view (as explained in {@link #getStartDate}
             * @param {Date} viewStart The first displayed date in the view
             * @param {Date} viewEnd The last displayed date in the view
             */
<span id='Extensible-calendar-CalendarPanel-event-beforeeventmove'>            /**
</span>             * @event beforeeventmove
             * Fires before an event element is dragged by the user and dropped in a new position. This is
             * a cancelable event, so returning false from a handler will cancel the move operation.
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.calendar.data.EventModel} rec The 
             * {@link Extensible.calendar.data.EventModel record} for the event that will be moved
             */
<span id='Extensible-calendar-CalendarPanel-event-eventmove'>            /**
</span>             * @event eventmove
             * Fires after an event element is dragged by the user and dropped in a new position
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.calendar.data.EventModel} rec The 
             * {@link Extensible.calendar.data.EventModel record} for the event that was moved with
             * updated start and end dates
             */
<span id='Extensible-calendar-CalendarPanel-event-initdrag'>            /**
</span>             * @event initdrag
             * Fires when a drag operation is initiated in the view
             * @param {Extensible.calendar.CalendarPanel} this
             */
<span id='Extensible-calendar-CalendarPanel-event-dayover'>            /**
</span>             * @event dayover
             * Fires while the mouse is over a day element
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Date} dt The date that is being moused over
             * @param {Ext.Element} el The day Element that is being moused over
             */
<span id='Extensible-calendar-CalendarPanel-event-dayout'>            /**
</span>             * @event dayout
             * Fires when the mouse exits a day element
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Date} dt The date that is exited
             * @param {Ext.Element} el The day Element that is exited
             */
<span id='Extensible-calendar-CalendarPanel-event-beforeeventresize'>            /**
</span>             * @event beforeeventresize
             * Fires after the user drags the resize handle of an event to resize it, but before the
             * resize operation is carried out. This is a cancelable event, so returning false from a
             * handler will cancel the resize operation. **NOTE:** This event is only fired
             * from views that support event resizing.
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.calendar.data.EventModel} rec The 
             * {@link Extensible.calendar.data.EventModel record} for the event that was resized
             * containing the updated start and end dates
             */
<span id='Extensible-calendar-CalendarPanel-event-eventresize'>            /**
</span>             * @event eventresize
             * Fires after the user drags the resize handle of an event and the resize operation is
             * complete. **NOTE:** This event is only fired from views that support event resizing.
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Extensible.calendar.data.EventModel} rec The 
             * {@link Extensible.calendar.data.EventModel record} for the event that was resized
             * containing the updated start and end dates
             */
<span id='Extensible-calendar-CalendarPanel-event-eventexception'>            /**
</span>             * @event eventexception
             * Fires after an event has been processed via an Ext proxy and returned with an exception. This
             * could be because of a server error, or because the data returned &lt;tt&gt;success: false&lt;/tt&gt;.
             *
             * The view provides default handling via the overrideable
             * {@link Extensible.calendar.view.AbstractCalendar#notifyOnException notifyOnException} method. If
             * any function handling this event returns false, the notifyOnException method will not be called.
             *
             * Note that only Server proxy and subclasses (including Ajax proxy) will raise this event.
             *
             * @param {Extensible.calendar.CalendarPanel} this
             * @param {Object} response The raw response object returned from the server
             * @param {Ext.data.Operation} operation The operation that was processed
             * @since 1.6.0
             */
        });
        
        this.addCls(&#39;x-cal-panel&#39;);
        
        if(this.eventStore) {
            this.store = this.eventStore;
            delete this.eventStore;
        }
        this.setStore(this.store);
        
        var sharedViewCfg = {
            showToday: this.showToday,
            todayText: this.todayText,
            showTodayText: this.showTodayText,
            showTime: this.showTime,
            readOnly: this.readOnly,
            recurrence: this.recurrence,
            store: this.store,
            calendarStore: this.calendarStore,
            editModal: this.editModal,
            enableEditDetails: this.enableEditDetails,
            startDay: this.startDay,
            ownerCalendarPanel: this
        };
        
        if(this.showDayView) {
            var day = Ext.apply({
                xtype: &#39;extensible.dayview&#39;,
                title: this.dayText
            }, sharedViewCfg);
            
            day = Ext.apply(Ext.apply(day, this.viewConfig), this.dayViewCfg);
            day.id = this.id+&#39;-day&#39;;
            this.initEventRelay(day);
            this.add(day);
        }
        if(this.showMultiDayView) {
            var mday = Ext.apply({
                xtype: &#39;extensible.multidayview&#39;,
                title: this.getMultiDayText(multiDayViewCount)
            }, sharedViewCfg);
            
            mday = Ext.apply(Ext.apply(mday, this.viewConfig), this.multiDayViewCfg);
            mday.id = this.id+&#39;-multiday&#39;;
            this.initEventRelay(mday);
            this.add(mday);
        }
        if(this.showWeekView) {
            var wk = Ext.applyIf({
                xtype: &#39;extensible.weekview&#39;,
                title: this.weekText
            }, sharedViewCfg);
            
            wk = Ext.apply(Ext.apply(wk, this.viewConfig), this.weekViewCfg);
            wk.id = this.id+&#39;-week&#39;;
            this.initEventRelay(wk);
            this.add(wk);
        }
        if(this.showMultiWeekView) {
            var mwk = Ext.applyIf({
                xtype: &#39;extensible.multiweekview&#39;,
                title: this.getMultiWeekText(multiWeekViewCount)
            }, sharedViewCfg);
            
            mwk = Ext.apply(Ext.apply(mwk, this.viewConfig), this.multiWeekViewCfg);
            mwk.id = this.id+&#39;-multiweek&#39;;
            this.initEventRelay(mwk);
            this.add(mwk);
        }
        if(this.showMonthView) {
            var month = Ext.applyIf({
                xtype: &#39;extensible.monthview&#39;,
                title: this.monthText,
                listeners: {
                    &#39;weekclick&#39;: {
                        fn: function(vw, dt) {
                            this.showWeek(dt);
                        },
                        scope: this
                    }
                }
            }, sharedViewCfg);
            
            month = Ext.apply(Ext.apply(month, this.viewConfig), this.monthViewCfg);
            month.id = this.id+&#39;-month&#39;;
            this.initEventRelay(month);
            this.add(month);
        }

        this.add(Ext.applyIf({
            xtype: &#39;extensible.eventeditform&#39;,
            id: this.id+&#39;-edit&#39;,
            calendarStore: this.calendarStore,
            recurrence: this.recurrence,
            startDay: this.startDay,
            listeners: {
                &#39;eventadd&#39;:    { scope: this, fn: this.onEventAdd },
                &#39;eventupdate&#39;: { scope: this, fn: this.onEventUpdate },
                &#39;eventdelete&#39;: { scope: this, fn: this.onEventDelete },
                &#39;eventcancel&#39;: { scope: this, fn: this.onEventCancel }
            }
        }, this.editViewCfg));
    },

<span id='Extensible-calendar-CalendarPanel-method-initEventRelay'>    initEventRelay: function(cfg) {
</span>        cfg.listeners = cfg.listeners || {};
        cfg.listeners.afterrender = {
            fn: function(c) {
                // Relay view events so that app code only has to handle them in one place.
                // These events require no special handling by the calendar panel.
                this.relayEvents(c, [&#39;eventsrendered&#39;, &#39;eventclick&#39;, &#39;dayclick&#39;, &#39;eventover&#39;, &#39;eventout&#39;,
                    &#39;beforedatechange&#39;, &#39;datechange&#39;, &#39;rangeselect&#39;, &#39;beforeeventcopy&#39;, &#39;eventcopy&#39;,
                    &#39;beforeeventmove&#39;, &#39;eventmove&#39;, &#39;initdrag&#39;, &#39;dayover&#39;, &#39;dayout&#39;, &#39;beforeeventresize&#39;,
                    &#39;eventresize&#39;, &#39;eventadd&#39;, &#39;eventupdate&#39;, &#39;beforeeventdelete&#39;, &#39;eventdelete&#39;,
                    &#39;eventcancel&#39;, &#39;eventexception&#39;]);
                
                c.on(&#39;editdetails&#39;, this.onEditDetails, this);
            },
            scope: this,
            single: true
        };
    },

<span id='Extensible-calendar-CalendarPanel-method-afterRender'>    afterRender: function() {
</span>        this.callParent(arguments);
        
        this.body.addCls(&#39;x-cal-body&#39;);
        this.updateNavState();
        this.setActiveView();
    },
    
<span id='Extensible-calendar-CalendarPanel-method-getMultiDayText'>    /**
</span>     * Returns the text to use for the &#39;X Days&#39; nav bar button (defaults to &quot;{0} Days&quot; where {0} is automatically replaced by the
     * value of the {@link #multDayViewCfg}&#39;s dayCount value if available, otherwise it uses the view default of 3).
     */
    getMultiDayText: function(numDays) {
        return this.multiDayText;
    },
    
<span id='Extensible-calendar-CalendarPanel-method-getMultiWeekText'>    /**
</span>     * Returns the text to use for the &#39;X Weeks&#39; nav bar button (defaults to &quot;{0} Weeks&quot; where {0} is automatically replaced by the
     * value of the {@link #multiWeekViewCfg}&#39;s weekCount value if available, otherwise it uses the view default of 2).
     */
    getMultiWeekText: function(numWeeks) {
        return this.multiWeekText;
    },
    
<span id='Extensible-calendar-CalendarPanel-method-setStore'>    /**
</span>     * Sets the event store used by the calendar to display {@link Extensible.calendar.data.EventModel events}.
     * @param {Ext.data.Store} store
     */
    setStore: function(store, initial) {
        var currStore = this.store;
        
        if(!initial &amp;&amp; currStore) {
            currStore.un(&quot;write&quot;, this.onWrite, this);
        }
        if(store) {
            store.on(&quot;write&quot;, this.onWrite, this);
        }
        this.store = store;
    },

<span id='Extensible-calendar-CalendarPanel-method-onStoreAdd'>    onStoreAdd: function(ds, recs, index) {
</span>        this.hideEditForm();
    },

<span id='Extensible-calendar-CalendarPanel-method-onStoreUpdate'>    onStoreUpdate: function(ds, rec, operation) {
</span>        if(operation === Ext.data.Record.COMMIT) {
            this.hideEditForm();
        }
    },

<span id='Extensible-calendar-CalendarPanel-method-onStoreRemove'>    onStoreRemove: function(ds, rec) {
</span>        this.hideEditForm();
    },

<span id='Extensible-calendar-CalendarPanel-method-onWrite'>    onWrite: function(store, operation) {
</span>        var rec = operation.records[0];
        
        switch(operation.action) {
            case &#39;create&#39;:
                this.onStoreAdd(store, rec);
                break;
            case &#39;update&#39;:
                this.onStoreUpdate(store, rec, Ext.data.Record.COMMIT);
                break;
            case &#39;destroy&#39;:
                this.onStoreRemove(store, rec);
                break;
        }
    },

<span id='Extensible-calendar-CalendarPanel-method-onEditDetails'>    onEditDetails: function(vw, rec, el) {
</span>        if(this.fireEvent(&#39;editdetails&#39;, this, vw, rec, el) !== false) {
            this.showEditForm(rec);
        }
    },

<span id='Extensible-calendar-CalendarPanel-method-save'>    save: function() {
</span>        // If the store is configured as autoSync:true the record&#39;s endEdit
        // method will have already internally caused a save to execute on
        // the store. We only need to save manually when autoSync is false,
        // otherwise we&#39;ll create duplicate transactions.
        if(!this.store.autoSync) {
            this.store.sync();
        }
    },

<span id='Extensible-calendar-CalendarPanel-method-onEventAdd'>    onEventAdd: function(form, rec) {
</span>        if(!rec.store) {
            this.store.add(rec);
            this.save();
        }
        this.fireEvent(&#39;eventadd&#39;, this, rec);
    },

<span id='Extensible-calendar-CalendarPanel-method-onEventUpdate'>    onEventUpdate: function(form, rec) {
</span>        this.save();
        this.fireEvent(&#39;eventupdate&#39;, this, rec);
    },

<span id='Extensible-calendar-CalendarPanel-method-onEventDelete'>    onEventDelete: function(form, rec) {
</span>        this.store.remove(rec);
        this.save();
        this.fireEvent(&#39;eventdelete&#39;, this, rec);
    },

<span id='Extensible-calendar-CalendarPanel-method-onEventCancel'>    onEventCancel: function(form, rec) {
</span>        this.hideEditForm();
        this.fireEvent(&#39;eventcancel&#39;, this, rec);
    },
    
<span id='Extensible-calendar-CalendarPanel-method-showEditForm'>    /**
</span>     * Shows the built-in event edit form for the passed in event record.  This method automatically
     * hides the calendar views and navigation toolbar.  To return to the calendar, call {@link #hideEditForm}.
     * @param {Extensible.calendar.data.EventModel} record The event record to edit
     * @return {Extensible.calendar.CalendarPanel} this
     */
    showEditForm: function(rec) {
        this.preEditView = this.layout.getActiveItem().id;
        this.setActiveView(this.id+&#39;-edit&#39;);
        this.layout.getActiveItem().loadRecord(rec);
        return this;
    },
    
<span id='Extensible-calendar-CalendarPanel-method-hideEditForm'>    /**
</span>     * Hides the built-in event edit form and returns to the previous calendar view. If the edit form is
     * not currently visible this method has no effect.
     * @return {Extensible.calendar.CalendarPanel} this
     */
    hideEditForm: function() {
        if(this.preEditView) {
            this.setActiveView(this.preEditView);
            delete this.preEditView;
        }
        return this;
    },
    
<span id='Extensible-calendar-CalendarPanel-method-setActiveView'>    /**
</span>     * Set the active view, optionally specifying a new start date.
     * @param {String/Number} id The id of the view to activate (or the 0-based index of the view within 
     * the CalendarPanel&#39;s internal card layout).
     * @param {Date} startDate (optional) The new view start date (defaults to the current start date)
     */
    setActiveView: function(id, startDate) {
        var me = this,
            layout = me.layout,
            editViewId = me.id + &#39;-edit&#39;,
            toolbar;
        
        if (startDate) {
            me.startDate = startDate;
        }
        
        // Make sure we&#39;re actually changing views
        if (id !== layout.getActiveItem().id) {
            // Show/hide the toolbar first so that the layout will calculate the correct item size
            toolbar = me.getDockedItems(&#39;toolbar&#39;)[0];
            if (toolbar) {
                toolbar[id === editViewId ? &#39;hide&#39; : &#39;show&#39;]();
            }
            
            // Activate the new view and refresh the layout
            layout.setActiveItem(id || me.activeItem);
            me.doComponentLayout();
            me.activeView = layout.getActiveItem();
            
            if (id !== editViewId) {
                if (id &amp;&amp; id !== me.preEditView) {
                    // We&#39;re changing to a different view, so the view dates are likely different.
                    // Re-set the start date so that the view range will be updated if needed.
                    // If id is undefined, it means this is the initial pass after render so we can
                    // skip this (as we don&#39;t want to cause a duplicate forced reload).
                    layout.activeItem.setStartDate(me.startDate, true);
                }
                // Switching to a view that&#39;s not the edit view (i.e., the nav bar will be visible)
                // so update the nav bar&#39;s selected view button
                me.updateNavState();
            }
            // Notify any listeners that the view changed
            me.fireViewChange();
        }
    },

<span id='Extensible-calendar-CalendarPanel-method-fireViewChange'>    fireViewChange: function() {
</span>        if (this.layout &amp;&amp; this.layout.getActiveItem) {
            var view = this.layout.getActiveItem(),
                cloneDt = Ext.Date.clone;
                
            if (view) {
                var info;
                
                // some views do not have these properties, e.g. the detailed edit form
                if (view.getViewBounds) {
                    var vb = view.getViewBounds();
                    info = {
                        viewStart: cloneDt(vb.start),
                        viewEnd: cloneDt(vb.end),
                        activeDate: cloneDt(view.getStartDate())
                    };
                }
                if (view.dismissEventEditor) {
                    view.dismissEventEditor();
                }
                this.fireEvent(&#39;viewchange&#39;, this, view, info);
            }
        }
    },

<span id='Extensible-calendar-CalendarPanel-method-updateNavState'>    updateNavState: function() {
</span>        var me = this,
            activeItem = me.layout.activeItem;
        
        if (activeItem &amp;&amp; me.showNavBar !== false) {
            var suffix = activeItem.id.split(me.id + &#39;-&#39;)[1],
                btn = Ext.getCmp(me.id + &#39;-tb-&#39; + suffix);
            
            if (me.showNavToday) {
                Ext.getCmp(me.id + &#39;-tb-today&#39;).setDisabled(activeItem.isToday());
            }
            btn.toggle(true);
        }
    },

<span id='Extensible-calendar-CalendarPanel-method-setStartDate'>    /**
</span>     * Sets the start date for the currently-active calendar view.
     * @param {Date} dt The new start date
     * @return {Extensible.calendar.CalendarPanel} this
     */
    setStartDate: function(dt) {
        Extensible.log(&#39;setStartDate (CalendarPanel&#39;);
        this.startDate = dt;
        this.layout.activeItem.setStartDate(dt, true);
        this.updateNavState();
        this.fireViewChange();
        return this;
    },

<span id='Extensible-calendar-CalendarPanel-method-showWeek'>    showWeek: function(dt) {
</span>        this.setActiveView(this.id+&#39;-week&#39;, dt);
    },

<span id='Extensible-calendar-CalendarPanel-method-onTodayClick'>    onTodayClick: function() {
</span>        this.startDate = this.layout.activeItem.moveToday(true);
        this.updateNavState();
        this.fireViewChange();
    },

<span id='Extensible-calendar-CalendarPanel-method-onJumpClick'>    onJumpClick: function() {
</span>        var dt = Ext.getCmp(this.id+&#39;-tb-jump-dt&#39;).getValue();
        if(dt !== &#39;&#39;) {
            this.startDate = this.layout.activeItem.moveTo(dt, true);
            this.updateNavState();
            // TODO: check that view actually changed:
            this.fireViewChange();
        }
    },

<span id='Extensible-calendar-CalendarPanel-method-onPrevClick'>    onPrevClick: function() {
</span>        this.startDate = this.layout.activeItem.movePrev(true);
        this.updateNavState();
        this.fireViewChange();
    },

<span id='Extensible-calendar-CalendarPanel-method-onNextClick'>    onNextClick: function() {
</span>        this.startDate = this.layout.activeItem.moveNext(true);
        this.updateNavState();
        this.fireViewChange();
    },

<span id='Extensible-calendar-CalendarPanel-method-onDayNavClick'>    onDayNavClick: function() {
</span>        this.setActiveView(this.id+&#39;-day&#39;);
    },

<span id='Extensible-calendar-CalendarPanel-method-onMultiDayNavClick'>    onMultiDayNavClick: function() {
</span>        this.setActiveView(this.id+&#39;-multiday&#39;);
    },

<span id='Extensible-calendar-CalendarPanel-method-onWeekNavClick'>    onWeekNavClick: function() {
</span>        this.setActiveView(this.id+&#39;-week&#39;);
    },

<span id='Extensible-calendar-CalendarPanel-method-onMultiWeekNavClick'>    onMultiWeekNavClick: function() {
</span>        this.setActiveView(this.id+&#39;-multiweek&#39;);
    },

<span id='Extensible-calendar-CalendarPanel-method-onMonthNavClick'>    onMonthNavClick: function() {
</span>        this.setActiveView(this.id+&#39;-month&#39;);
    },
    
<span id='Extensible-calendar-CalendarPanel-method-getActiveView'>    /**
</span>     * Return the calendar view that is currently active, which will be a subclass of
     * {@link Extensible.calendar.view.AbstractCalendar AbstractCalendar}.
     * @return {Extensible.calendar.view.AbstractCalendar} The active view
     */
    getActiveView: function() {
        return this.layout.activeItem;
    }
});</pre>
</body>
</html>
